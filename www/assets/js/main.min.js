$(function(){$(document).on("click",".replyButton",function(e){e.preventDefault(),$(this).closest(".post").find(".replyComment").addClass("open")}),$(document).on("click",".reply .voteup, .reply .votedown",function(e){e.preventDefault();var t=$(this),o={type:t.attr("vote-type"),post_id:t.closest(".post").attr("id"),created_by:userId};$.ajax({type:"POST",url:urlSite+"api/vote",data:o,dataType:"json"}).success(function(e){if(e.error)return void alert(e.message);e.neutral?t.closest(".reply").find(".forVote a").removeClass("voted"):t.find("a").addClass("voted animated flash");var o=$("#"+t.closest(".post").attr("id")).find(".badgeVote"),a=e.upvotes.length-e.downvotes.length;if("undefined"==typeof o[0]){var n=$('<span class="badgeVote animated bounceIn">                     <i>'+a+"</i>                 </span>");0>a&&n.addClass("negative"),$($("#"+t.closest(".post").attr("id")).find(".avatarArea a")[0]).append(n)}else 0===a?$(o[0]).remove():$(o[0]).find("i").text(a),0>a&&$(o[0]).addClass("negative")}).fail(function(e){alert("Error while posting"),console.log(e)})}),$(document).on("submit",".replyForPost",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=$(this),o=$(t.find("textarea")[0]);post={post_id:t.attr("post-id"),created_by:userId,content:o.val()},o.val(""),t.closest(".replyComment").removeClass("open"),$.ajax({type:"POST",url:urlSite+"api/reply",data:post,dataType:"json"}).success(function(e){t.closest(".replyComment").removeClass("open"),t.closest(".postPoint").append(makeReplyDom(e,!1))}).fail(function(e){alert("Error while posting"),console.log(e)})}),$(".noiseForm").submit(function(e){e.preventDefault(),e.stopImmediatePropagation();var t=$(this),o=$(t.find("textarea")[0]);post={thread_id:threadId,created_by:userId,content:o.val()},o.val(""),$.ajax({type:"POST",url:urlSite+"api/reply",data:post,dataType:"json"}).success(function(e){renderReply(e,!1)}).fail(function(e){console.log(e)})})});
